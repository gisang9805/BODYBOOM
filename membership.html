<!-- 👇 기존 HTML 상단은 그대로 유지 -->

<!-- ② 회원권 정보 -->
<h3>② 회원권 정보</h3>
<table>
  <tr>
    <th>회원권 종류</th>
    <td>
      <label><input type="radio" name="membership_type" value="헬스"> 헬스</label>
      &nbsp;&nbsp;
      <label><input type="radio" name="membership_type" value="헬스+스피닝"> 헬스+스피닝</label>
    </td>
  </tr>
  <tr>
    <th>계약 유형</th>
    <td>
      <select name="contract_type">
        <option value="신규">신규</option>
        <option value="재가입">재가입</option>
        <option value="만기된 회원 재가입">만기된 회원 재가입</option>
        <option value="업그레이드">업그레이드</option>
        <option value="양도">양도</option>
      </select>
    </td>
  </tr>
  <tr>
    <th>선불 기간</th>
    <td>
      <select name="prepaid_months">
        <option value="">선택</option>
        <option value="1">1개월</option>
        <option value="3">3개월</option>
        <option value="6">6개월</option>
        <option value="12">12개월</option>
      </select>
    </td>
  </tr>
  <tr><th>운동 시작일</th><td><input type="date" name="start_date"></td></tr>
  <tr><th>계약 금액 (₩)</th><td><input type="text" name="contract_amount" readonly></td></tr>

  <tr>
    <th>운동복 (₩)</th>
    <td>
      <label><input type="radio" name="uniform_use" value="O"> O</label>
      <label><input type="radio" name="uniform_use" value="X"> X</label>
      &nbsp;&nbsp;
      <input type="text" name="uniform_fee" readonly>
    </td>
  </tr>

  <tr>
    <th>락커 (₩)</th>
    <td>
      <label><input type="radio" name="locker_use" value="O"> O</label>
      <label><input type="radio" name="locker_use" value="X"> X</label>
      &nbsp;&nbsp;
      <input type="text" name="locker_fee" readonly>
    </td>
  </tr>

  <tr>
    <th>등록비 (₩)</th>
    <td>
      <label><input type="radio" name="registration_use" value="O"> O</label>
      <label><input type="radio" name="registration_use" value="X"> X</label>
      &nbsp;&nbsp;
      <input type="text" name="registration_fee" readonly>
    </td>
  </tr>

  <tr>
    <th>총금액 (₩)</th>
    <td><input type="text" name="total_amount" readonly></td>
  </tr>
</table>

<!-- 👇 운동 정보, 기타 항목 및 기존 스크립트들 그대로 유지 -->

<!-- ✅ 자동 계산 스크립트 (폼 하단에 삽입) -->
<script>
  const membershipTypeInputs = document.querySelectorAll('input[name="membership_type"]');
  const prepaidSelect = document.querySelector('select[name="prepaid_months"]');
  const contractAmountInput = document.querySelector('input[name="contract_amount"]');

  const uniformInputs = document.querySelectorAll('input[name="uniform_use"]');
  const lockerInputs = document.querySelectorAll('input[name="locker_use"]');
  const registrationInputs = document.querySelectorAll('input[name="registration_use"]');

  const uniformFee = document.querySelector('input[name="uniform_fee"]');
  const lockerFee = document.querySelector('input[name="locker_fee"]');
  const registrationFee = document.querySelector('input[name="registration_fee"]');
  const totalAmount = document.querySelector('input[name="total_amount"]');

  function updateContractAmount() {
    const type = document.querySelector('input[name="membership_type"]:checked')?.value;
    const months = prepaidSelect.value;
    const priceMap = {
      "헬스": {"1": 90000, "3": 240000, "6": 450000, "12": 840000},
      "헬스+스피닝": {"1": 120000, "3": 330000, "6": 600000, "12": 1100000}
    };
    const price = (type && months && priceMap[type]?.[months]) ? priceMap[type][months] : 0;
    contractAmountInput.value = price ? price.toLocaleString() : "";
    updateExtraFees();
  }

  function updateExtraFees() {
    const months = parseInt(prepaidSelect.value) || 0;

    const uniformSelected = document.querySelector('input[name="uniform_use"]:checked')?.value;
    const uniform = (uniformSelected === 'O') ? months * 10000 : 0;
    uniformFee.value = uniform ? uniform.toLocaleString() : '';

    const lockerSelected = document.querySelector('input[name="locker_use"]:checked')?.value;
    const locker = (lockerSelected === 'O') ? months * 10000 : 0;
    lockerFee.value = locker ? locker.toLocaleString() : '';

    const registrationSelected = document.querySelector('input[name="registration_use"]:checked')?.value;
    const registration = (registrationSelected === 'O') ? 0 : (registrationSelected === 'X' ? 20000 : 0);
    registrationFee.value = registration ? registration.toLocaleString() : '0';

    updateTotalAmount();
  }

  function parseAmount(str) {
    return parseInt(str.replace(/[^0-9]/g, "")) || 0;
  }

  function updateTotalAmount() {
    const contract = parseAmount(contractAmountInput.value);
    const uniform = parseAmount(uniformFee.value);
    const locker = parseAmount(lockerFee.value);
    const registration = parseAmount(registrationFee.value);

    const total = contract + uniform + locker + registration;
    totalAmount.value = total ? total.toLocaleString() : '';
  }

  membershipTypeInputs.forEach(input => input.addEventListener("change", updateContractAmount));
  prepaidSelect.addEventListener("change", updateContractAmount);
  uniformInputs.forEach(input => input.addEventListener("change", updateExtraFees));
  lockerInputs.forEach(input => input.addEventListener("change", updateExtraFees));
  registrationInputs.forEach(input => input.addEventListener("change", updateExtraFees));
</script>
